# ==========================================================================
# RVV Backend: Single Source of Truth (Scripting)
# ==========================================================================
# This file defines the locked variables for the RISC-V Vector backend.
# It is sourced by all scripts in scripts/rvv/ to ensure consistency.
#
# Reference: extra/rvv/CONVENTIONS.md
# ==========================================================================

# --------------------------------------------------------------------------
# 1. Identity & Target
# --------------------------------------------------------------------------
# The internal name used by the simdjson runtime registry
IMPL_KEY="rvv"

# The target architecture/ABI for the compiler
MARCH_BASELINE="rv64gcv"
MABI="lp64d"

# --------------------------------------------------------------------------
# 2. QEMU Emulation (The "Hardware" Environment)
# --------------------------------------------------------------------------
# Canonical CPU string for QEMU.
# NOTE: 'vlen=${VLEN}' is a placeholder that must be substituted by the
#       consuming script (usually via `eval` or string replacement).
#       We enable 'rvv_ta_all_1s' and 'rvv_ma_all_1s' to catch masking bugs.
QEMU_CPU_TEMPLATE="rv64,v=true,rvv_ta_all_1s=true,rvv_ma_all_1s=true,vlen=\${VLEN}"

# --------------------------------------------------------------------------
# 3. CMake Configuration (Build System)
# --------------------------------------------------------------------------
# Standard flags to ensure the RVV backend is compiled and tools are built.
# We use SIMDJSON_ENABLE_RV64=ON as the stable repo hook.
COMMON_CMAKE_FLAGS="-DSIMDJSON_ENABLE_RV64=ON -DSIMDJSON_ENABLE_TESTS=ON -DSIMDJSON_ENABLE_TOOLS=ON -DSIMDJSON_ENABLE_BENCHMARKS=ON"

# --------------------------------------------------------------------------
# 4. Output Formats
# --------------------------------------------------------------------------
BENCH_FORMAT="csv"
BENCH_DIR_PREFIX="build/rvv"